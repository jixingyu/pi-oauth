<?php
// Root id
$commentRootId = $comment['root'];
// Count
$commentCount = $comment['count'];
// Target data:
// Title, time, user
// uid, name, avatar, profile_url
$commentTarget = $comment['target'];
// Comment list generated by comment module:
// id, time, content, user
// uid, name, avatar, profile_url, IP
$commentList = $comment['items'];
// Pagination object
$paginator = $comment['paginator'];

if ($commentList) {
    /*
    $uids = array();
    foreach ($commentList as $comment) {
        $uids[] = (int) $comment['uid'];
    }
    $avatars = Pi::avatar()->getList($uids, 'small');
    $users = Pi::user()->get($uids, 'name');
    foreach ($users as $uid => &$user) {
        $user['url'] = Pi::user()->getUrl('profile', $uid);
        $user['avatar'] = $avatars[$uid];
    }
    */
?>
    <div class="pi-comment-header">
        <dl class="dl-horizontal">
            <dt><?php _e('Comments'); ?></dt>
            <dt><?php _e('Total:') ?></dt>
            <dd><?php echo $commentCount; ?></dd>
            <dt><?php _e('Source:') ?></dt>
            <dd><?php echo $commentTarget['title']; ?></dd>
            <dt><?php _e('URL:') ?></dt>
            <dd><?php echo $commentTarget['url']; ?></dd>
            <dt><?php _e('Author:') ?></dt>
            <dd><?php echo $commentTarget['user']['name']; ?></dd>
            <dt><?php _e('Time:') ?></dt>
            <dd><?php echo _date($commentTarget['time']); ?></dd>
        </dl>
    </div>
    <div class="pi-comment-list">
<?php
    foreach ($commentList as $item) {
?>
        <dl class="dl-horizontal pi-comment-item">
            <dt><?php _e('User name:');?></dt>
            <dd><?php echo $item['user']['name']; ?></dd>
            <dt><?php _e('User profile:');?></dt>
            <dd><?php echo $item['user']['url']; ?></dd>
            <dt><?php _e('User avatar:');?></dt>
            <dd><?php echo $item['user']['avatar']; ?></dd>
            <dt><?php _e('Time:');?></dt>
            <dd><?php echo _date($item['time']); ?></dd>
            <dt><?php _e('Content:');?></dt>
            <dd><?php echo $item['content']; ?></dd>
        </dl>
<?php
    }
?>
    </div>
<?php
    if ($paginator) {
        $this->pagination($paginator);
    }
}
?>